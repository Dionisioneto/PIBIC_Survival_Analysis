200
1.2,0.1,0.1,0.1,0.1,
n.intervalos = 6
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,3,2,65,100,300),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
# inferior = c(0,0,0,
#              0,
#              -1000,-1000,-1000,-1000,-1000,
#              -1000,-1000,-1000,-1000)
#
# superior = c(1000,1000,1000,
#              100,
#              1000,1000,1000,1000,1000,
#              1000,1000,1000,1000)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
est.mepp.smoke$par
est.mepp.smoke$value
n.intervalos = 6
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,3,2,10,100,300),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
# inferior = c(0,0,0,
#              0,
#              -1000,-1000,-1000,-1000,-1000,
#              -1000,-1000,-1000,-1000)
#
# superior = c(1000,1000,1000,
#              100,
#              1000,1000,1000,1000,1000,
#              1000,1000,1000,1000)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 6
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,3,2,65,100,300),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
inferior = c(0,0,0,0,0,0,
0,
-1000,-1000,-1000,-1000,-1000,
-1000,-1000,-1000,-1000)
superior = c(1000,1000,1000,1000,1000,1000,
100,
1000,1000,1000,1000,1000,
1000,1000,1000,1000)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
lower=inferior,
upper=superior,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 6
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,3,2,65,100,300),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
inferior = c(0,0,0,0,0,0,
0,
-1000,-1000,-1000,-1000,-1000,
-1000,-1000,-1000,-1000)
superior = c(1000,1000,1000,1000,1000,1000,
100,
1000,1000,1000,1000,1000,
1000,1000,1000,1000)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "L-BFGS-B",
control=list(fnscale=1), hessian = T,
lower=inferior,
upper=superior,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 6
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,3,2,65,100,300),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
inferior = c(0,0,0,0,0,0,
0,
-1000,-1000,-1000,-1000,-1000,
-1000,-1000,-1000,-1000)
superior = c(1000,1000,1000,1000,1000,1000,
100,
1000,1000,1000,1000,1000,
1000,1000,1000,1000)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "L-BFGS-B",
control=list(fnscale=1), hessian = T,
lower=inferior,
upper=superior,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
tratamento = smoke2009$SIUC # Tipo de tratamento (SI/UC)
n_cigarros = smoke2009$F10Cigs_pad # Numero de cigarros fumados por dia, normalizado
duracao_dependente = smoke2009$Duration_pad # Duracao como dependente, normalizado
sexo = smoke2009$SexF
covariaveis = cbind(tratamento, sexo, n_cigarros, duracao_dependente)
n.intervalos = 6
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,3,2,65,100,300),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
est.mepp.smoke$par
est.mepp.smoke$value
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,3,2,65,100,300,300),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,3,2,65,100,200,300),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
est.mepp.smoke$par
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,65,100,200,300),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
covariaveis = cbind(tratamento, sexo, n_cigarros, duracao_dependente)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,65,100,200,300),
250,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
covariaveis = cbind(tratamento, sexo, n_cigarros, duracao_dependente)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,65,100,200,300),
250,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,65,100,200,300),
400,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,65,100,200,300),
400,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,65,100,200,200),
400,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,65,100,200,200),
400,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,0.3,100,200,200),
400,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,0.3,100,200,200),
400,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,0.3,0.3,200,200),
400,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,0.3,0.3,200,200),
400,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,0.3,0.3,300,400),
400,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,0.3,0.3,300,400),
4200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,0.3,0.2,0.3,3,200,200),
4200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,5,0.2,0.3,3,200,200),
4200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,5,0.2,0.3,3,200,200),
4200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,5,0.2,0.3,3,200,200),
4200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,5,0.2,0.3,3,200,200),
420,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,5,0.2,0.3,3,200,200),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,5,0.2,0.3,3,200,200),
200,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,5,0.2,0.3,3,200,200),
100,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
n.intervalos = 7
grid.obs=time.grid.interval(li=smoke2009$Timept1, ri=smoke2009$Timept2,
type="OBS", bmax=n.intervalos)
grid.obs=grid.obs[-c(1, length(grid.obs))]
chute = c(c(5,5,0.2,0.3,3,200,200),
100,
1.2,0.1,0.1,0.1,0.1,
0.1,0.1,0.1,0.1)
est.mepp.smoke <- optim(par = chute, fn=loglikIC, gr = NULL,
method = "BFGS",
control=list(fnscale=1), hessian = T,
l=smoke2009$Timept1,
r=smoke2009$Timept2,
x.cure=covariaveis, x.risk=cbind(1, covariaveis),
grid=grid.obs)
